<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Wonderland</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
</head>
<body>
    <center>
      <h1>My Wonderland 詞句組合</h1>
      <div>
        <label for="attraction">景點名稱:<br></label>
        <input type="text" id="attraction">
        <br>
        <br>
        <label for="cardlist">詞卡編號(以,隔開):<br></label>
        <input type="text" id="cardlist">
        <br>
        <br>

        <button onclick="mySentence()">詞句組合</button>
        
      </div>
      <br>
      <br>
      <div id="output">
        <p>My Wonderland: 善用AI發揮創意，打造心中美麗世界，展開新奇探索旅程。</p>
      </div>
      <br>
        <br>
        <button onclick="mySubmit()">繳&nbsp;&nbsp;送</button>

    </center>

    <script crossorigin="use-credentials">

    function mySentence() {
      const cardlist = document.getElementById('cardlist').value;
      if (cardlist) {
        var card=[  '壯觀的','遼闊的','迷人的','雄偉的','碧綠的','蔚藍的','多彩的','高聳的',
                    '蓬勃的','璀璨的','茂盛的','鮮豔的',
                    '荒涼的','污染的','混亂的','沈悶的','無趣的','陰鬱的','黯淡的','死寂的',
                    '山脈','河川','湖泊','瀑布','天空','星夜','雲朵','陽光','樹木','花朵',
                    '建築物','天際線','輕舟','飛鳥','晚霞'
                 ];

        const attraction = document.getElementById('attraction');
        const output = document.getElementById('output');
        output.innerHTML = "";
        
        try{
            var t1="";
            var t2="";
            var arr = cardlist.split(",");
            for(var i=0; i<arr.length; i++)
            {
                var d=parseInt(arr[i]);
                if(d>=1 && d<=20)
                {
                    d--;
                    t1 += card[d] + "、";
                }
                else if(d>=21 && d<=35)
                {
                    d--;
                    t2 += card[d] + "、";
                }
            }

            if(t1.length>1) t1=t1.substring(0,t1.length-1);
            if(t2.length>1) t2="，畫面中的元素包含" + t2.substring(0,t2.length-1);
            
            output.innerHTML = "一幅" + t1 + attraction.value + "景色" + t2 + "。";
        }
        catch
        {
              output.innerHTML = "error!";
        }

      }


    }


    function mySubmit()
    {
        var myMessage = document.getElementById('output').value;
        console.log(myMessage);
        let url = 'https://script.google.com/macros/s/AKfycbz9L1xMP49gXMd9Bm_LVq7NPK29xEH9xQ0_4i6gKHu1IkFSlebT7MzodjAioPSwpJOx/exec';
        $.post(url,
            {msg:myMessage}
        )
        
    }
    </script>
</body>
</html>